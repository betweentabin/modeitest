<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LocalStorage クリア</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            background-color: #da5761;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 0;
            font-size: 16px;
        }
        button:hover {
            background-color: #c44853;
        }
        .info {
            background-color: #e7f3ff;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }
        pre {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            overflow: auto;
            max-height: 300px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧹 LocalStorage データ管理</h1>
        
        <div class="info">
            <p><strong>説明:</strong> ページ管理画面で正しい数のページが表示されない場合、localStorageに古いデータが残っている可能性があります。</p>
        </div>

        <h2>現在のCMSデータ</h2>
        <button onclick="showCurrentData()">現在のデータを表示</button>
        <div id="currentData"></div>

        <h2>操作</h2>
        <button onclick="clearCMSData()">CMSデータをクリア</button>
        <button onclick="resetToDefaults()">デフォルトデータにリセット</button>
        <button onclick="clearAllStorage()">全localStorageをクリア</button>
        
        <div id="result"></div>

        <h2>ページ管理画面へ</h2>
        <button onclick="goToPageManagement()">ページ管理画面を開く</button>
    </div>

    <script>
        const STORAGE_KEY = 'cms_mock_data';

        function showCurrentData() {
            const data = localStorage.getItem(STORAGE_KEY);
            const resultDiv = document.getElementById('currentData');
            
            if (data) {
                try {
                    const parsedData = JSON.parse(data);
                    const pagesCount = Object.keys(parsedData.pages || {}).length;
                    
                    resultDiv.innerHTML = `
                        <div class="info">
                            <p><strong>ページ数:</strong> ${pagesCount}件</p>
                            <p><strong>その他のデータ:</strong></p>
                            <ul>
                                <li>セミナー: ${(parsedData.seminars || []).length}件</li>
                                <li>刊行物: ${(parsedData.publications || []).length}件</li>
                                <li>お知らせ: ${(parsedData.notices || []).length}件</li>
                                <li>会員: ${(parsedData.members || []).length}件</li>
                            </ul>
                        </div>
                        <h3>ページ一覧:</h3>
                        <pre>${JSON.stringify(parsedData.pages, null, 2)}</pre>
                    `;
                } catch (e) {
                    resultDiv.innerHTML = `<div style="color: red;">データの解析に失敗: ${e.message}</div>`;
                }
            } else {
                resultDiv.innerHTML = '<div class="info">localStorageにCMSデータが見つかりません。</div>';
            }
        }

        function clearCMSData() {
            localStorage.removeItem(STORAGE_KEY);
            document.getElementById('result').innerHTML = 
                '<div class="success">✅ CMSデータをクリアしました。ページをリロードしてください。</div>';
        }

        function resetToDefaults() {
            // デフォルトページデータを設定
            const defaultPages = {
                home: { title: 'トップページ', content: 'ちくぎん地域経済研究所のメインページ', lastUpdated: '2025-05-01' },
                about: { title: 'ちくぎん地域経済研究所について', content: '地域経済の発展に貢献する研究機関です。', lastUpdated: '2025-05-01' },
                services: { title: 'サービス一覧', content: '経済調査、コンサルティング、セミナー開催など', lastUpdated: '2025-04-28' },
                news: { title: 'お知らせ', content: 'お知らせ一覧ページ', lastUpdated: '2025-04-28' },
                newsDetail: { title: 'お知らせ詳細', content: 'お知らせ記事の詳細ページ', lastUpdated: '2025-04-28' },
                seminars: { title: 'セミナー', content: 'セミナー情報ページ', lastUpdated: '2025-04-28' },
                seminarRegistration: { title: 'セミナー申込', content: 'セミナー申込フォーム', lastUpdated: '2025-04-28' },
                publications: { title: '刊行物', content: '刊行物一覧ページ', lastUpdated: '2025-04-28' },
                publicationDetail: { title: '刊行物詳細', content: '刊行物詳細ページ', lastUpdated: '2025-04-28' },
                memberLogin: { title: '会員ログイン', content: '会員ログインページ', lastUpdated: '2025-04-28' },
                memberRegister: { title: '会員登録', content: '会員登録ページ', lastUpdated: '2025-04-28' },
                myAccount: { title: 'マイアカウント', content: '会員マイページ', lastUpdated: '2025-04-28' },
                upgrade: { title: 'プランアップグレード', content: '会員プランアップグレードページ', lastUpdated: '2025-04-28' },
                faq: { title: 'よくある質問', content: 'よくある質問と回答', lastUpdated: '2025-04-28' },
                apply: { title: '申込みフォーム', content: '各種申込みフォーム', lastUpdated: '2025-04-28' },
                contact: { title: 'お問い合わせ', content: 'お問い合わせフォーム', lastUpdated: '2025-04-28' },
                glossary: { title: '用語集', content: '経済用語集', lastUpdated: '2025-04-28' },
                privacy: { title: 'プライバシーポリシー', content: 'プライバシーポリシーページ', lastUpdated: '2025-04-28' },
                terms: { title: '利用規約', content: '利用規約ページ', lastUpdated: '2025-04-28' },
                adminLogin: { title: '管理者ログイン', content: '管理者ログインページ', lastUpdated: '2025-04-28' },
                adminDashboard: { title: '管理ダッシュボード', content: '管理画面のダッシュボード', lastUpdated: '2025-04-28' },
                test: { title: 'テストページ', content: 'Vue.js動作確認用テストページ', lastUpdated: '2025-04-28' }
            };

            const defaultData = {
                seminars: [],
                publications: [],
                notices: [],
                media: [],
                members: [],
                pages: defaultPages
            };

            localStorage.setItem(STORAGE_KEY, JSON.stringify(defaultData));
            document.getElementById('result').innerHTML = 
                `<div class="success">✅ デフォルトデータにリセットしました。${Object.keys(defaultPages).length}ページが追加されました。</div>`;
        }

        function clearAllStorage() {
            localStorage.clear();
            document.getElementById('result').innerHTML = 
                '<div class="success">✅ 全localStorageをクリアしました。</div>';
        }

        function goToPageManagement() {
            window.open('/#/admin/pages', '_blank');
        }

        // ページ読み込み時に現在のデータを表示
        window.onload = function() {
            showCurrentData();
        };
    </script>
</body>
</html>
