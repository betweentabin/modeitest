<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storage Debug</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        pre {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            border-radius: 3px;
        }
        button:hover {
            background: #005a9e;
        }
        .info {
            color: #4ec9b0;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>🔍 Storage Debug Tool</h1>
    
    <div class="info" id="info"></div>
    
    <button onclick="showCurrent()">現在のStorage表示</button>
    <button onclick="showPagesOnly()">Pagesのみ表示</button>
    <button onclick="fixStorage()">Storage修正実行</button>
    <button onclick="clearAndReload()">クリアして再読み込み</button>
    
    <pre id="output"></pre>

    <script>
        const STORAGE_KEY = 'cms_mock_data';
        
        function showCurrent() {
            const data = localStorage.getItem(STORAGE_KEY);
            if (data) {
                const parsed = JSON.parse(data);
                const info = document.getElementById('info');
                info.innerHTML = `
                    データ概要: 
                    - Seminars: ${parsed.seminars?.length || 0}件
                    - Publications: ${parsed.publications?.length || 0}件
                    - Notices: ${parsed.notices?.length || 0}件
                    - Pages: ${parsed.pages ? Object.keys(parsed.pages).length : 0}件
                `;
                document.getElementById('output').textContent = JSON.stringify(parsed, null, 2);
            } else {
                document.getElementById('output').textContent = 'No data in localStorage';
            }
        }
        
        function showPagesOnly() {
            const data = localStorage.getItem(STORAGE_KEY);
            if (data) {
                const parsed = JSON.parse(data);
                document.getElementById('output').textContent = 
                    'Pages データ:\n' + JSON.stringify(parsed.pages, null, 2);
            }
        }
        
        function fixStorage() {
            // 現在のデータを取得
            const currentData = localStorage.getItem(STORAGE_KEY);
            let data = currentData ? JSON.parse(currentData) : {};
            
            // pagesが不完全な場合は修正
            const expectedPages = {
                about: {
                    title: 'ちくぎん地域経済研究所について',
                    content: '地域経済の発展に貢献する研究機関です。',
                    lastUpdated: '2025-05-01'
                },
                services: {
                    title: 'サービス一覧',
                    content: '経済調査、コンサルティング、セミナー開催など',
                    lastUpdated: '2025-04-28'
                },
                seminars: {
                    title: 'セミナー',
                    content: 'セミナー情報ページ',
                    lastUpdated: '2025-04-28'
                },
                publications: {
                    title: '刊行物',
                    content: '刊行物一覧ページ',
                    lastUpdated: '2025-04-28'
                },
                news: {
                    title: 'お知らせ',
                    content: 'お知らせ一覧ページ',
                    lastUpdated: '2025-04-28'
                },
                contact: {
                    title: 'お問い合わせ',
                    content: 'お問い合わせフォーム',
                    lastUpdated: '2025-04-28'
                },
                faq: {
                    title: 'よくある質問',
                    content: 'よくある質問と回答',
                    lastUpdated: '2025-04-28'
                },
                glossary: {
                    title: '用語集',
                    content: '経済用語集',
                    lastUpdated: '2025-04-28'
                },
                privacy: {
                    title: 'プライバシーポリシー',
                    content: 'プライバシーポリシーページ',
                    lastUpdated: '2025-04-28'
                },
                terms: {
                    title: '利用規約',
                    content: '利用規約ページ',
                    lastUpdated: '2025-04-28'
                }
            };
            
            // pagesを完全に置き換え
            data.pages = expectedPages;
            
            // 保存
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            
            // 確認表示
            const info = document.getElementById('info');
            info.innerHTML = `✅ 修正完了！Pages: ${Object.keys(data.pages).length}件に更新されました`;
            
            showCurrent();
        }
        
        function clearAndReload() {
            localStorage.removeItem(STORAGE_KEY);
            location.reload();
        }
        
        // 初期表示
        showCurrent();
    </script>
</body>
</html>